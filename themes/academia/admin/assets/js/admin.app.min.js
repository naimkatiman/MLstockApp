!function(a){"use strict";var b={initialize:function(){b.meta_box_tab(),b.process_post_format(),b.required_field(),b.header_layout_hover(),b.initTaxMetaIconSelect()},meta_box_tab:function(){var b=a(meta_box_ids);a("#normal-sortables").after('<div class="g5plus-meta-tabs-wrap postbox"><div class="handlediv" title="Click to toggle"><br></div><h3 class="hndle"><span>Pages Options</span></h3><div id="g5plus-tabbed-meta-boxes"></div></div>'),a(b).appendTo("#g5plus-tabbed-meta-boxes"),a(b).hide().removeClass("hide-if-no-js");for(var c=0,d=b.length;c<d;c++){var e="editor-tab"+c;a(b[c]).addClass(e)}for(var f='<ul id="g5plus-meta-box-tabs" class="clearfix">\n',g=0,h=0,i=b.length;h<i;h++){var j=a(b[h]).attr("id"),k=a(b[h]).find(".hndle > span").text();a(b[h]).hasClass("hide-if-js")&&g++,f=f+'\n<li id="li-'+j+'" class="'+""+'"><a href="#" rel="editor-tab'+h+'">'+k+"</a></li>"}f+="\n</ul>",a("#g5plus-tabbed-meta-boxes").before(f),a("#g5plus-meta-box-tabs a:first").addClass("active"),a(".editor-tab0").addClass("active").show(),a(".g5plus-meta-tabs-wrap").on("click",".handlediv",function(){var b=a(this).parent();b.hasClass("closed")?b.removeClass("closed"):b.addClass("closed")}),a("#g5plus-meta-box-tabs li").on("click","a",function(){a(b).removeClass("active").hide(),a("#g5plus-meta-box-tabs a").removeClass("active");var c=a(this).attr("rel");return a(this).addClass("active"),a("."+c).addClass("active").show(),!1})},get_input_val:function(a){var b=a.val();return a.is(":checkbox")&&(b=a.prop("checked")?a.val():"0"),b},requiredGetApplyFiled:function(a){var b=[],c=0;if("object"==typeof a[0])for(var d=0;d<a.length;d++){var e=a[d];if("object"==typeof e[0])for(var f=0;f<e.length;f++)b[c++]=e[f][0],"&"==e[f][1].substr(0,1)&&(b[c++]=e[f][2]);else b[c++]=e[0],"&"==e[1].substr(0,1)&&(b[c++]=e[2])}else b[c++]=a[0],"&"==a[1].substr(0,1)&&(b[c++]=a[2]);return b},process_post_format:function(){var b="g5plus_",c=a("input[name=post_format]","#post-formats-select"),d=a('[id^="'+b+'meta_box_post_format_"]').hide();c.change(function(){d.hide(),a("#"+b+"meta_box_post_format_"+a(this).val()).show()}),c.filter(":checked").trigger("change"),a("body").on("change",".checkbox-toggle input",function(){var d,b=a(this),c=b.closest(".checkbox-toggle");d=c.hasClass("reverse")?b.is(":checked")?"slideUp":"slideDown":b.is(":checked")?"slideDown":"slideUp",c.next()[d]()}),a(".checkbox-toggle input").trigger("change")},requiredToggle:function(a,c,d){var e=!0;if("object"==typeof c[0])for(var f=0;f<c.length;f++){var g=c[f];if("object"==typeof g[0]){for(var h=!1,i=0;i<g.length;i++){var j=g[i];if(h=b.requiredFieldProcess(j))break}e=h}else e=b.requiredFieldProcess(g);if(!e)break}else e=b.requiredFieldProcess(c);e?d?a.slideDown():a.show():d?a.slideUp():a.hide()},requiredFieldProcess:function(c){var d=c[0],e=c[1],f=c[2],g=b.get_input_val(a("#"+d));return"object"==typeof f?"="==e&&-1!=f.indexOf(g)||"<>"==e&&-1==f.indexOf(g):("&"==e.substr(0,1)&&(f=b.get_input_val(a("#"+f)),e=e.substr(1)),"="==e&&f==g||"<>"==e&&f!=g)},required_field:function(){var c=[];a("[data-required]").each(function(){var d=a(this),e=JSON.parse(d.attr("data-required"));if("object"==typeof e[0])for(var f=0;f<e.length;f++){var g=e[f];if("object"==typeof g[0])for(var h=0;h<g.length;h++)c[g[h][0]]=!0,"&"==g[h][1].substr(0,1)&&(c[g[h][2]]=!0);else c[g[0]]=!0,"&"==g[1].substr(0,1)&&(c[g[2]]=!0)}else c[e[0]]=!0,"&"==e[1].substr(0,1)&&(c[e[2]]=!0);b.requiredToggle(d,e,!1)});for(var d in c)a("#"+d).change(function(){var c=a(this);a("[data-required]").each(function(){var d=a(this),e=JSON.parse(d.attr("data-required")),f=b.requiredGetApplyFiled(e),g=c.attr("id");-1!=f.indexOf(g)&&b.requiredToggle(d,e,!0)})})},header_layout_hover:function(){a("#g5plus_megatron_options-header_layout li.redux-image-select").on("hover",function(b){var d=(a(this),a(this).closest("tr"));if(0!=d.length){var e=a("label > img",this).attr("src"),f=a("label > input",this).attr("value"),g=e.replace(f+".png",f+"-hover.png");"mouseenter"==b.type?(0==a(".header-layout-hover-wrapper").length&&a(d).after('<tr class="header-layout-hover-wrapper"><td colspan="2"><img src="'+g+'"/></td></tr>'),a(".header-layout-hover-wrapper img").attr("src",g),a(".header-layout-hover-wrapper").show()):a(".header-layout-hover-wrapper").hide()}})},initTaxMetaIconSelect:function(){jQuery.isFunction(jQuery.fn.select2)&&a(".at-select").select2({formatResult:b.formatIconState,formatSelection:b.formatIconState})},formatIconState:function(b){return b.id?a('<span><i class="'+b.element[0].value.toLowerCase()+'"/> '+b.text+"</span>"):b.text}};a(document).ready(function(){b.initialize()})}(jQuery);